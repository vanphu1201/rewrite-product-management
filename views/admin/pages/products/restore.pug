extends ../../layouts/default
include ../../mixins/multi-change.pug
include ../../mixins/alert.pug
block main
    if (role.permissions.includes("products_restore"))
        table.table.table-hover.table-sm
            thead
                tr
                    th STT
                    th Hình ảnh
                    th Tiêu đề
                    th Giá
                    th Vị trí
                    th Người tạo
                    th Người xóa
                    th Trạng thái
                    th Khôi phục
            tbody
                each item, index in products
                    tr
                        td #{index + 1}
                        td
                            img(
                                src=item.thumbnail
                                alt=item.title
                                width="100px"
                                height="auto"
                            )
                        td #{item.title}
                        td #{item.price}$
                        td
                            input(
                            type="number"
                            value=item.position
                            style="width: 60px"
                            min="1"
                            name="position"
                            )
                        td 
                            p #{item.fullNameCreate}
                            p #{moment(item.createdBy.createdAt).format('DD MM YYYY, h:mm:ss')}
                        td 
                            p #{item.fullNameDelete}
                            p #{moment(item.deletedBy.deletedAt).format('DD MM YYYY, h:mm:ss')}
                        td
                            if (role.permissions.includes("products_edit"))
                                if (item.status == "active")
                                    a(href="javascript:;" class="badge badge-success" data-status=item.status data-id=item.id) Hoạt động
                                else 
                                    a(href="javascript:;" class="badge badge-danger" data-status=item.status data-id=item.id) Dừng hoạt động
                            else 
                                a(href="#" class="badge badge-secondary") Không cấp quyền
                        td 
                            a(href=`/admin/products/restore/${item.id}` class="badge badge-primary" restore) Khôi phục
            //- form submit
            form(
                action=""
                method="POST"
                path="/admin/products/change-status"
                form-change-status
            )

            form(
                action=""
                method="POST"
                path="/admin/products/delete"
                form-delete-product
            )
    else 
        h1 Bạn không có quyền truy cập trang này